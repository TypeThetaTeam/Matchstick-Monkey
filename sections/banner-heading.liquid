<!-- sections/image-heading-section.liquid -->
{% schema %}
{
  "name": "Banner Heading",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Your Heading Here"
    },
    {
      "type": "image_picker",
      "id": "image_desktop",
      "label": "Desktop Banner Image"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Mobile Banner Image"
    },
    {
      "type": "text",
      "id": "alt_text",
      "label": "Image Alt Text",
      "default": "Image description"
    },
    {
      "type": "range",
      "id": "banner_width_desktop",
      "label": "Banner Width (Desktop %)",
      "min": 30,
      "max": 100,
      "step": 5,
      "default": 60
    },
    {
      "type": "range",
      "id": "banner_height_desktop",
      "label": "Banner Max Height (Desktop px)",
      "min": 200,
      "max": 1200,
      "step": 50,
      "default": 600
    },
    {
      "type": "range",
      "id": "text_size_desktop",
      "label": "Text Size (Desktop px)",
      "min": 16,
      "max": 64,
      "step": 2,
      "default": 32
    },
    {
      "type": "range",
      "id": "text_size_mobile",
      "label": "Text Size (Mobile px)",
      "min": 12,
      "max": 48,
      "step": 2,
      "default": 24
    }
  ],
  "presets": [
    {
      "name": "Banner Heading"
    }
  ]
}
{% endschema %}

<style>
  .image-heading-section h2,
  .image-heading-section picture {
    opacity: 0;
    transform: scale(0.9) translateY(30px);
    transition: all 1.2s ease-out;
  }

  .image-heading-section--visible h2,
  .image-heading-section--visible picture {
    opacity: 1;
    transform: scale(1) translateY(0);
  }

  .image-heading-section {
    text-align: center;
    padding:30px 0px;
    width: 100%;
    box-sizing: border-box;
  }

  .image-heading-section h2 {
    font-size: {{ section.settings.text_size_desktop }}px;
    margin: 0;
    padding: 0;
    font-weight: 700;
    word-break: break-word;
  }

  .image-heading-section picture img {
    width: {{ section.settings.banner_width_desktop }}%;
    max-width: 100%;
    max-height: {{ section.settings.banner_height_desktop }}px;
    height: auto;
    display: block;
    margin: 0 auto;
    object-fit: contain;
    padding: 20px 0px;
  }

  @media (max-width: 768px) {
    .image-heading-section h2 {
      font-size: {{ section.settings.text_size_mobile }}px;
      padding: 0 15px;
    }

    .image-heading-section picture img {
      width: 100%;
      max-width: 100%;
      height: auto;
      max-height: none;
      padding: 20px 0px;
    }
  }
</style>

<div class="image-heading-section">
  {% if section.settings.heading != blank %}
    <h2>{{ section.settings.heading }}</h2>
  {% endif %}

  {% if section.settings.image_desktop != blank or section.settings.image_mobile != blank %}
    <picture>
      {% if section.settings.image_mobile != blank %}
        <source
          srcset="{{ section.settings.image_mobile | img_url: '800x' }}"
          media="(max-width: 768px)"
        >
      {% endif %}
      {% if section.settings.image_desktop != blank %}
        <img
          src="{{ section.settings.image_desktop | img_url: '1600x' }}"
          alt="{{ section.settings.alt_text }}"
        >
      {% endif %}
    </picture>
  {% endif %}
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const section = document.querySelector('.image-heading-section');

    if (section) {
      const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            section.classList.add('image-heading-section--visible');
            observer.unobserve(entry.target);
          }
        });
      }, {
        threshold: 0.3
      });

      observer.observe(section);
    }
  });
</script>
